## 2024-05-23 - Code Splitting Routes with AnimatePresence
**Learning:** Implementing code splitting (`React.lazy`) on `react-router-dom` routes wrapped in `AnimatePresence` requires careful handling. `AnimatePresence` relies on the direct child having a unique `key` to trigger exit animations. Since `Routes` handles the rendering, we must place the `key={location.pathname}` prop on `Routes` itself. However, TypeScript definitions for `Routes` might not explicitly allow `key` (despite it being a valid React prop), requiring a `@ts-expect-error` suppression.
**Action:** When combining `AnimatePresence`, `Routes`, and `Suspense`, ensure `Suspense` wraps `AnimatePresence` (or vice versa depending on desired loading behavior) and `Routes` is keyed. Use the `import().then(m => ({ default: m.NamedExport }))` pattern for lazy loading named exports.
